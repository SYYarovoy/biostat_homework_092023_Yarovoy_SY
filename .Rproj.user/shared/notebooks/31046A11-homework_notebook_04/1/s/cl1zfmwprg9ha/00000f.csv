"0","# Поскольку функция теста Шапиро-Уилка не разрешает задавать на проверку векторы более чем из 5000 значений, пробуем создать серию выборок по 5000 значений из каждой количественной переменной и в каждой выборке проверить нормальность распределения, подсчитав количество результатов с p-value менее 0.05: "
"0",""
"0","# Для переменной Age"
"0","df1 <- data.frame(n_test = 1:100, `p-value` = NA)"
"0","for(i in 1:100) {df1$p[i] = shapiro.test(sample(cleaned_data$Age, 5000))[2]}"
"0","print(paste0(""Age: p-value = "", sum(df1$p < 0.05))) # Все значения p-value оказались менее 0.05 - распределение переменной Age отлично от нормального."
"1","[1]"
"1"," ""Age: p-value = 100"""
"1","
"
"0","# Можно также попробовать убрать выбросы (по правилу 3 сигм остается более 5000 значений, поэтому пробуем другой вариант поиска выбросов - менее quantile(0.25) - 1.5 * IQR или более quantile(0.75) + 1.5 * IQR:"
"0","n_outliers <- cleaned_data %>%"
"0","  filter(between(Age, quantile(Age, 0.25, na.rm = TRUE) - 1.5 * IQR(Age, na.rm = TRUE), quantile(Age, 0.75, na.rm = TRUE) + 1.5 * IQR(Age, na.rm = TRUE)) & between(Average_glucose_level, quantile(Average_glucose_level, 0.25, na.rm = TRUE) - 1.5 * IQR(Average_glucose_level, na.rm = TRUE), quantile(Average_glucose_level, 0.75, na.rm = TRUE) + 1.5 * IQR(Average_glucose_level, na.rm = TRUE)) & between(BMI, quantile(Age, 0.25, na.rm = TRUE) - 1.5 * IQR(BMI, na.rm = TRUE), quantile(BMI, 0.75, na.rm = TRUE) + 1.5 * IQR(BMI, na.rm = TRUE)))"
"0",""
"0","shapiro.test(n_outliers$Age) # Значение p-value  менее 0.05 - распределение переменной Age отлично от нормального."
"1","
"
"1","	Shapiro-Wilk normality test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","n_outliers$Age"
"1",""
"1","
"
"1","W = 0.97031, p-value < 2.2e-16"
"1","
"
"1","
"
"0","# Для переменной Average_glucose_level"
"0","df2 <- data.frame(n_test = 1:100, `p-value` = NA)"
"0","for(i in 1:100) {df2$p[i] = shapiro.test(sample(cleaned_data$Average_glucose_level, 5000))[2]}"
"0","print(paste0(""Average_glucose_rate: p-value = "", sum(df2$p < 0.05))) # Все значения p-value оказались менее 0.05 - распределение переменной BMI отлично от нормального."
"1","[1]"
"1"," ""Average_glucose_rate: p-value = 100"""
"1","
"
"0","# Исключение выбросов:"
"0","n_outliers <- cleaned_data %>%"
"0","  filter(between(Age, quantile(Age, 0.25, na.rm = TRUE) - 1.5 * IQR(Age, na.rm = TRUE), quantile(Age, 0.75, na.rm = TRUE) + 1.5 * IQR(Age, na.rm = TRUE)) & between(Average_glucose_level, quantile(Average_glucose_level, 0.25, na.rm = TRUE) - 1.5 * IQR(Average_glucose_level, na.rm = TRUE), quantile(Average_glucose_level, 0.75, na.rm = TRUE) + 1.5 * IQR(Average_glucose_level, na.rm = TRUE)) & between(BMI, quantile(BMI, 0.25, na.rm = TRUE) - 1.5 * IQR(BMI, na.rm = TRUE), quantile(BMI, 0.75, na.rm = TRUE) + 1.5 * IQR(BMI, na.rm = TRUE)))"
"0",""
"0","shapiro.test(n_outliers$Average_glucose_level) # Значение p-value  менее 0.05 - распределение переменной BMI отлично от нормального."
"1","
"
"1","	Shapiro-Wilk normality test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","n_outliers$Average_glucose_level"
"1",""
"1","
"
"1","W = 0.95188, p-value < 2.2e-16"
"1","
"
"1","
"
"0","# Для переменной BMI"
"0","df3 <- data.frame(n_test = 1:100, `p-value` = NA)"
"0","for(i in 1:100) {df3$p[i] = shapiro.test(sample(cleaned_data$BMI, 5000))[2]}"
"0","print(paste0(""BMI: p-value = "", sum(df3$p < 0.05))) # Все значения p-value оказались менее 0.05 - распределение переменной BMI отлично от нормального."
"1","[1]"
"1"," ""BMI: p-value = 100"""
"1","
"
"0","# Исключение выбросов:"
"0","n_outliers <- cleaned_data %>%"
"0","  filter(between(Age, quantile(Age, 0.25, na.rm = TRUE) - 1.5 * IQR(Age, na.rm = TRUE), quantile(Age, 0.75, na.rm = TRUE) + 1.5 * IQR(Age, na.rm = TRUE)) & between(Average_glucose_level, quantile(Average_glucose_level, 0.25, na.rm = TRUE) - 1.5 * IQR(Average_glucose_level, na.rm = TRUE), quantile(Average_glucose_level, 0.75, na.rm = TRUE) + 1.5 * IQR(Average_glucose_level, na.rm = TRUE)) & between(BMI, quantile(BMI, 0.25, na.rm = TRUE) - 1.5 * IQR(BMI, na.rm = TRUE), quantile(BMI, 0.75, na.rm = TRUE) + 1.5 * IQR(BMI, na.rm = TRUE)))"
"0",""
"0","shapiro.test(n_outliers$BMI) # Значение p-value  менее 0.05 - распределение переменной BMI отлично от нормального."
"1","
"
"1","	Shapiro-Wilk normality test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","n_outliers$BMI"
"1",""
"1","
"
"1","W = 0.98846, p-value < 2.2e-16"
"1","
"
"1","
"
"0","  "
"0",""
